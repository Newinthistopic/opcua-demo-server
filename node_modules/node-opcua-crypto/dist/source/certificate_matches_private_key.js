"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.certificateMatchesPrivateKey = void 0;
const crypto_utils_1 = require("./crypto_utils");
/**
 * check that the given certificate matches the given private key
 * @param certificate
 * @param privateKey
 */
function certificateMatchesPrivateKeyPEM(certificate, privateKey) {
    const initialBuffer = Buffer.from("Lorem Ipsum");
    const encryptedBuffer = (0, crypto_utils_1.publicEncrypt_long)(initialBuffer, certificate, 256, 11);
    const decryptedBuffer = (0, crypto_utils_1.privateDecrypt_long)(encryptedBuffer, privateKey, 256);
    return initialBuffer.toString("utf-8") === decryptedBuffer.toString("utf-8");
}
function certificateMatchesPrivateKey(certificate, privateKey) {
    const certificatePEM = (0, crypto_utils_1.toPem)(certificate, "CERTIFICATE");
    const privateKeyPEM = (0, crypto_utils_1.toPem)(privateKey, "RSA PRIVATE KEY");
    return certificateMatchesPrivateKeyPEM(certificatePEM, privateKeyPEM);
}
exports.certificateMatchesPrivateKey = certificateMatchesPrivateKey;
//# sourceMappingURL=certificate_matches_private_key.js.map